<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: 
    lightArgs: "<projectname>.wixobj" -out "<projectname>.msi" -ext WixUIExtension -cultures:hu-hu
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <?define PRODUCTVERSION = "0.1.2" ?>
  <Product Id="*" Language="1038" Manufacturer="Kir-Dev" Name="Printer Client" Version="$(var.PRODUCTVERSION)" Codepage="1250" UpgradeCode="423B4258-71D3-4036-BB87-DF44EC9F344C">
    <Package Compressed="yes" Description="Printer Client Installer" Id="*" InstallerVersion="100" Languages="1038" />
    <UI />
    <UIRef Id="WixUI_InstallDir" />
    <UIRef Id="WixUI_ErrorProgressText" />
    <Media Id="1" Cabinet="printerclient.cab" EmbedCab="yes" />
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder" Name="Program Files">
        <Directory Id="Kir_Dev" Name="Kir-Dev">
          <Directory Id="INSTALLDIR" Name="Printer Client">
            <Component Id="dist" DiskId="1" Guid="27B7E3B0-2B01-4E68-8239-AB574EFAF044">
              <File Id="w9xpopen.exe" Name="w9xpopen.exe" Source="dist\w9xpopen.exe" />
              <File Id="PrinterClient.exe" Name="PrinterClient.exe" Source="dist\PrinterClient.exe" KeyPath="yes" />
              <Shortcut Id="startMenuExe" Name="Printer Client" Directory="ProgramMenuDir" Icon="PrinterClient.exe" IconIndex="0" Advertise="yes" WorkingDirectory="INSTALLDIR" />
              <Shortcut Id="desktopExe" Name="Printer Client" Advertise="yes" Directory="DesktopFolder" Icon="PrinterClient.exe" IconIndex="0" WorkingDirectory="INSTALLDIR" />
              <RemoveFile Id="LogFiles" Name="*.log" On="uninstall" />
            </Component>
            <Directory Id="res" Name="res">
              <Component Id="res" DiskId="1" Guid="25C5B79F-8B37-4712-9BA2-C5B3A6ACD351">
                <File Id="printer_delete.png" Name="printer_delete.png" Source="dist\res\printer_delete.png" />
                <File Id="printer_error.png" Name="printer_error.png" Source="dist\res\printer_error.png" />
                <File Id="accept.png" Name="accept.png" Source="dist\res\accept.png" />
                <File Id="bullet_green.png" Name="bullet_green.png" Source="dist\res\bullet_green.png" />
                <File Id="bullet_red.png" Name="bullet_red.png" Source="dist\res\bullet_red.png" />
                <File Id="printer.png" Name="printer.png" Source="dist\res\printer.png" />
                <File Id="error.png" Name="error.png" Source="dist\res\error.png" />
                <File Id="printer_empty.png" Name="printer_empty.png" Source="dist\res\printer_empty.png" />
              </Component>
            </Directory>
          </Directory>
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder" Name="Programs">
        <Directory Id="ProgramMenuDir_Kir_Dev" Name="Kir-Dev">
          <Directory Id="ProgramMenuDir" Name="Printer Client">
            <Component Id="ProgramMenuDir" Guid="7F6FAE00-ADE2-44B1-958B-8B259F979AFA">
              <RemoveFolder Id="ProgramMenuDir" On="uninstall" />
              <RegistryValue Key="Software\Kir-Dev\Printer Client" KeyPath="yes" Root="HKCU" Type="string" Value="" />
            </Component>
          </Directory>
          <Component Id="ProgramMenuDir_Kir_Dev" Guid="F7123973-FCD1-4372-BFEF-C41E9AA02800">
            <RemoveFolder Id="ProgramMenuDir_Kir_Dev" On="uninstall" />
            <RegistryValue Key="Software\Kir-Dev\Printer Client" KeyPath="yes" Root="HKCU" Type="string" Value="" />
          </Component>
        </Directory>
      </Directory>
      <Directory Id="DesktopFolder" Name="Desktop" />
      <Component Id="autostart" Guid="28C82161-C512-4518-A6BE-F35458619563">
        <RegistryValue Action="write" Id="autostartKey" Key="Software\Microsoft\Windows\CurrentVersion\Run" KeyPath="yes" Root="HKCU" Type="string" Value="[INSTALLDIR]PrinterClient.exe" Name="PrinterClient" />
      </Component>
    </Directory>
    <Feature Id="Complete" Level="1" ConfigurableDirectory="INSTALLDIR" Description="Teljes telepítés">
      <ComponentRef Id="dist" />
      <ComponentRef Id="res" />
      <ComponentRef Id="ProgramMenuDir" />
      <ComponentRef Id="autostart" />
      <ComponentRef Id="ProgramMenuDir_Kir_Dev" />
    </Feature>
    <Icon Id="PrinterClient.exe" SourceFile="src\HP-Printer.ico" />
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLDIR" />
    <Upgrade Id="423B4258-71D3-4036-BB87-DF44EC9F344C">
      <UpgradeVersion Property="NEWERVERSIONDETECTED" Minimum="$(var.PRODUCTVERSION)" OnlyDetect="yes" />
      <UpgradeVersion Property="OLDERVERSIONBEINGUPGRADED" Maximum="$(var.PRODUCTVERSION)" OnlyDetect="no" IncludeMaximum="no" />
    </Upgrade>
    <InstallExecuteSequence>
      <RemoveExistingProducts After="InstallInitialize" />
    </InstallExecuteSequence>
    <WixVariable Id="WixUILicenseRtf" Value="license.rtf" />
  </Product>
</Wix>